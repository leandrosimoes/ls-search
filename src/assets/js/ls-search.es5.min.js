"use strict";(function(n,t){function v(n){return typeof n=="function"}function y(n){var t=this,i;if(!t||!n||typeof t!="string")return t;for(i=0;i<n.length;i++)t=t.replace("{"+i+"}",n[i]);return t}function p(n){var i,t;if(!n)throw'You forget to define the "options", please, see the docs for more information.';if(!n.element)throw'You must define "element" options.';if(!n.engines||n.engines.length>0)for(i=0;i<n.engines.length;i++){if(t=n.engines[i],!t.name)throw'All engines must have the "name" options defined.';if(!t.template)throw'All engines must have the "template" options defined.';if(!t.url)throw'You must define "{0}" or "{1}" options of engine "{2}".'.stringFormat(["url","data",t.name]);if(!t.formatResult)throw'You cannot define both "{0}" and "{1}" options of engine "{2}".'.stringFormat(["formatResult",t.name]);if(!v(t.formatResult))throw'The "{0}" option of "{1}" engine must be a function.'.stringFormat(["formatResult",t.name]);}else throw"You must define at least one search engine.";}function w(n){return Object.keys(n).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")}function b(n){var i=new XMLHttpRequest,f=n.method||"GET",u=n.url||"",s=n.callback||function(n){console.log(n)},r=n.params||{},h=n.template||"";if(!u)throw"You must define the url options to make an AJAX request.";r=c(r,{term:n.term});i.onreadystatechange=function(){if(i.readyState==4&&i.status==200&&!e){t.dispatchEvent(new Event("ls-search.endevent"));var r=t.getElementsByClassName("ls-search-results-container")[0],n=t.createElement("div");n.className="ls-search-item";n.appendChild(k(h));r.appendChild(n);s(i.responseText)}e&&(o=0)};f==="GET"&&(u+="?"+w(r));i.open(f,u,!0);i.setRequestHeader("X-Requested-With","XMLHttpRequest");i.setRequestHeader("Content-Type","application/json; charset=utf-8");i.send(JSON.stringify(r))}function k(n){var i={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],area:[1,"<map>","<\/map>"],param:[1,"<object>","<\/object>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],body:[0,"",""],_default:[1,"<div>","<\/div>"]},s,h,l,f,e,u,o,r,c;if(i.optgroup=i.option,i.tbody=i.tfoot=i.colgroup=i.caption=i.thead,i.th=i.td,s=/<\s*\w.*?>/g.exec(n),r=t.createElement("div"),s!=null){if(h=s[0].replace(/</g,"").replace(/>/g,"").split(" ")[0],h.toLowerCase()==="body"){for(l=t.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null),f=t.createElement("body"),r.innerHTML=n.replace(/<body/g,"<div").replace(/<\/body>/g,"<\/div>"),e=r.firstChild.attributes,f.innerHTML=n,u=0;u<e.length;u++)f.setAttribute(e[u].name,e[u].value);return f}for(o=i[h]||i._default,n=o[1]+n+o[2],r.innerHTML=n,c=o[0]+1;c--;)r=r.lastChild}else r.innerHTML=n,r=r.lastChild;return r}function d(n,i){var r,u;if(n&&i&&i.length!==0)for(r=0;r<i.length;r++)u=i[r],f.push(i[r]),t.createEvent("Event").initEvent(i[r].name,!0,!0),t.addEventListener(i[r].name,function(t){b({method:t.detail.method,url:t.detail.url,callback:t.detail.formatResult,params:t.detail.params,async:t.detail.async,template:t.detail.template,term:n.value})})}function s(n){var i,f,r;if(e=!1,n||(u=!1),i=t.getElementsByClassName("ls-search-item"),f=i.length-1,!!i&&f>=0)for(r=f;r>=0;r--)i[r].parentNode.removeChild(i[r])}function g(n,c){var a=n,v=n.parentNode.getElementsByClassName("ls-search-container")[0];t.createEvent("Event").initEvent("ls-search.opensearch",!0,!0);t.createEvent("Event").initEvent("ls-search.closesearch",!0,!0);t.createEvent("Event").initEvent("ls-search.endevent",!0,!0);a.addEventListener("ls-search.opensearch",function(n){t.body.parentNode.className.indexOf("nonscroll")==-1&&(t.body.parentNode.className+=" nonscroll");n.target.ls_open||(n.target.ls_open=!0);l(n.target,!0)},!1);a.addEventListener("ls-search.closesearch",function(n){t.body.parentNode.className=t.body.parentNode.className.replace(" nonscroll","");!n.target.ls_open||(n.target.ls_open=!1);u||(n.target.value="");l(a);s(!!u)},!1);t.addEventListener("ls-search.endevent",function(){o-1==0&&(a.parentNode.getElementsByClassName("ls-search-container")[0].className="ls-search-container has-result");o--});t.addEventListener("click",function(n){n.stopPropagation();a.dispatchEvent(new Event("ls-search.closesearch"))});t.addEventListener("blur",function(n){n.stopPropagation();a.dispatchEvent(new Event("ls-search.closesearch"))});a.addEventListener("click",function(n){n.stopPropagation();a.dispatchEvent(new Event("ls-search.opensearch"))},!1);a.addEventListener("focus",function(n){n.stopPropagation();a.dispatchEvent(new Event("ls-search.opensearch"));s(!!u)},!1);a.addEventListener("keyup",function(n){var l=a;if(clearTimeout(h),!l.value){!u||!i||typeof i!="function"||(u=!1,i());a.dispatchEvent(new Event("ls-search.closesearch"));e=!0;return}if(l.value.length<c){!u||!i||typeof i!="function"||(u=!1,i());e=!0;s();return}switch(n.keyCode?n.keyCode:n.which){case 27:case 37:case 38:case 39:case 40:break;default:h=setTimeout(function(){var e,n,h,c;for(s(),l.parentNode.getElementsByClassName("ls-search-container")[0].className="ls-search-container searching",!!r&&r.length>0&&(e=function(n,t){for(var i,f,r,u=[],e=0;e<t.length;e++)if(i=n.filter(function(n){return n.name!==undefined&&typeof n.name=="string"?n.name===t[e]:!1}),!!i&&i.length>0)for(f=0;f<i.length;f++)u.push(i[f]);for(r=0;r<n.length;r++)u.indexOf(n[r])==-1&&u.push(n[r]);return u},f=e(f,r)),n=0;n<f.length;n++)h=!r||r.length===0||r.indexOf(f[n].name)>-1,h&&(c=new CustomEvent(f[n].name,{detail:f[n]}),t.dispatchEvent(c),o++);u=!!i&&typeof i=="function";u&&i(l.value)},500)}},!1);v.addEventListener("click",function(n){n.stopPropagation()},!1)}function nt(n){var i=t.createElement("div"),r=t.createElement("div"),e=t.createTextNode("Hi! How can I help you?"),u=t.createElement("div"),o=t.createTextNode("Searching..."),f=t.createElement("div");i.className="ls-search-container ls-search-hidden";r.className="ls-search-default";u.className="ls-search-searching";f.className="ls-search-results-container";r.appendChild(e);u.appendChild(o);i.appendChild(r);i.appendChild(u);i.appendChild(f);n.parentNode.insertBefore(i,n)}function l(n,t){var i=n.parentNode.getElementsByClassName("ls-search-container")[0];i.style.top=n.clientHeight+n.offsetTop+n.clientTop+"px";i.style.left=n.clientLeft+n.offsetLeft-2+"px";i.style.width=n.offsetWidth+"px";i.className=t?"ls-search-container":"ls-search-container ls-search-hidden"}var f=[],o=0,e=!1,r=[],i,u,h,c=function c(){var n={},i=!1,t=0,f=arguments.length,r,u;for(Object.prototype.toString.call(arguments[0])==="[object Boolean]"&&(i=arguments[0],t++),r=function(t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=i&&Object.prototype.toString.call(t[r])==="[object Object]"?c(!0,n[r],t[r]):t[r])};t<f;t++)u=arguments[t],r(u);return n},a=function a(n){p(n);var t={element:n.element,engines:n.engines,minInputLength:n.minInputLength||1,setPriorities:function(n){if(n.constructor!==Array)throw"The priorities value must be an Array";if(!!n&&n.length>0){r=[];for(var t=0;t<n.length;t++)r.push(n[t])}return this},getPriorities:function(){return r},clearPriorities:function(){return r=[],this},setFilter:function(n){if(!n||typeof n!="function")throw"The filter must be a function";return i=n,this},getFilters:function(){return LsFilters},clearFilter:function(){return!i||typeof i!="function"||i(),i=null,this},go:function(n){return!!n&&n.length>=t.minInputLength&&(t.element.value=n,t.element.dispatchEvent(new Event("keyup"))),this},close:function(){return this.element.dispatchEvent(new Event("ls-search.closesearch")),this}};t.element.ls_seach||(t.element.ls_search=function(){a(n)},nt(t.element),g(t.element,t.minInputLength),d(t.element,t.engines));n.element.ls_search=t};String.prototype.stringFormat=y;n.ls_search=a})(window,document);